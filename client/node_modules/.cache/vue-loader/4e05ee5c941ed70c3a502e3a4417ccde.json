{"remainingRequest":"/Users/jiyu/midori/manga/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jiyu/midori/manga/client/src/components/Block/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jiyu/midori/manga/client/src/components/Block/index.vue","mtime":1538275024949},{"path":"/Users/jiyu/midori/manga/client/node_modules/cache-loader/dist/cjs.js","mtime":1538224308710},{"path":"/Users/jiyu/midori/manga/client/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jiyu/midori/manga/client/node_modules/cache-loader/dist/cjs.js","mtime":1538224308710},{"path":"/Users/jiyu/midori/manga/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tloaded: false,\n\t\t\timg: null,\n\t\t\tvisible: [true],\n\t\t\tnb_block: this.$route.params.id\n\t\t}\n\t},\n\tmethods: {\n\t\thandleScroll(nb_page) {\n\t\t\tlet elem = this.$refs[`page_${nb_page}`]\n\t\t\tconsole.log(elem)\n\t\t\tif(!this.visible[nb_page]) {\n\t\t\t\tlet top = elem.getBoundingClientRect().top\n\t\t\t\tthis.visible[nb_page] = top < window.innerHeight + 100\n\t\t\t}\n\t\t\tif(this.visible[nb_page]) {\n\t\t\t\twindow.removeEventListener('scroll', this.handleScroll)\n\n\t\t\t\tthis.rpc(\"block\", \"read\", { nb_block: this.nb_block, nb_page: nb_page+1 }, false).then(r => {\n\t\t\t\t\tlet newImg = document.createElement(\"img\")\n\t\t\t\t\tnewImg.src = r.img\n\t\t\t\t\tnewImg.ref = `page_${nb_page+1}`\n\t\t\t\t\tthis.$refs.read_manga.appendChild(newImg)\n\n\t\t\t\t\twindow.addEventListener('scroll', () => {\n\t\t\t\t\t\tthis.handleScroll(nb_page+1)\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t},\n\twatch: {\n\t\tvisible(v) {\n\t\t\tconsole.log(`${v} is visible.`)\n\t\t}\n\t},\n\tcreated() {\n\t\tthis.rpc(\"block\", \"read\", { nb_block: this.nb_block, nb_page: 0 }, true).then(r => {\n\t\t\tthis.img = r.img\n\t\t\tconsole.log(\"r\", r)\n\t\t\twindow.addEventListener('scroll', () => {\n\t\t\t\tthis.handleScroll(0)\n\t\t\t})\n\t\t}).finally(r => {\n\t\t\tthis.loaded = true\n\t\t})\n\t}\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/Block","sourcesContent":["<template src=\"./template.html\"></template>\n<style src=\"./style.css\"></style>\n\n<script>\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tloaded: false,\n\t\t\timg: null,\n\t\t\tvisible: [true],\n\t\t\tnb_block: this.$route.params.id\n\t\t}\n\t},\n\tmethods: {\n\t\thandleScroll(nb_page) {\n\t\t\tlet elem = this.$refs[`page_${nb_page}`]\n\t\t\tconsole.log(elem)\n\t\t\tif(!this.visible[nb_page]) {\n\t\t\t\tlet top = elem.getBoundingClientRect().top\n\t\t\t\tthis.visible[nb_page] = top < window.innerHeight + 100\n\t\t\t}\n\t\t\tif(this.visible[nb_page]) {\n\t\t\t\twindow.removeEventListener('scroll', this.handleScroll)\n\n\t\t\t\tthis.rpc(\"block\", \"read\", { nb_block: this.nb_block, nb_page: nb_page+1 }, false).then(r => {\n\t\t\t\t\tlet newImg = document.createElement(\"img\")\n\t\t\t\t\tnewImg.src = r.img\n\t\t\t\t\tnewImg.ref = `page_${nb_page+1}`\n\t\t\t\t\tthis.$refs.read_manga.appendChild(newImg)\n\n\t\t\t\t\twindow.addEventListener('scroll', () => {\n\t\t\t\t\t\tthis.handleScroll(nb_page+1)\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t},\n\twatch: {\n\t\tvisible(v) {\n\t\t\tconsole.log(`${v} is visible.`)\n\t\t}\n\t},\n\tcreated() {\n\t\tthis.rpc(\"block\", \"read\", { nb_block: this.nb_block, nb_page: 0 }, true).then(r => {\n\t\t\tthis.img = r.img\n\t\t\tconsole.log(\"r\", r)\n\t\t\twindow.addEventListener('scroll', () => {\n\t\t\t\tthis.handleScroll(0)\n\t\t\t})\n\t\t}).finally(r => {\n\t\t\tthis.loaded = true\n\t\t})\n\t}\n}\n</script>\n"]}]}