{"remainingRequest":"/Users/jiyu/midori/manga/client/node_modules/babel-loader/lib/index.js!/Users/jiyu/midori/manga/client/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/jiyu/midori/manga/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jiyu/midori/manga/client/src/components/Block/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jiyu/midori/manga/client/src/components/Block/index.vue","mtime":1538275024949},{"path":"/Users/jiyu/midori/manga/client/node_modules/cache-loader/dist/cjs.js","mtime":1538224308710},{"path":"/Users/jiyu/midori/manga/client/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jiyu/midori/manga/client/node_modules/cache-loader/dist/cjs.js","mtime":1538224308710},{"path":"/Users/jiyu/midori/manga/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\nexport default {\n  data: function data() {\n    return {\n      loaded: false,\n      img: null,\n      visible: [true],\n      nb_block: this.$route.params.id\n    };\n  },\n  methods: {\n    handleScroll: function handleScroll(nb_page) {\n      var _this = this;\n\n      var elem = this.$refs[\"page_\".concat(nb_page)];\n      console.log(elem);\n\n      if (!this.visible[nb_page]) {\n        var top = elem.getBoundingClientRect().top;\n        this.visible[nb_page] = top < window.innerHeight + 100;\n      }\n\n      if (this.visible[nb_page]) {\n        window.removeEventListener('scroll', this.handleScroll);\n        this.rpc(\"block\", \"read\", {\n          nb_block: this.nb_block,\n          nb_page: nb_page + 1\n        }, false).then(function (r) {\n          var newImg = document.createElement(\"img\");\n          newImg.src = r.img;\n          newImg.ref = \"page_\".concat(nb_page + 1);\n\n          _this.$refs.read_manga.appendChild(newImg);\n\n          window.addEventListener('scroll', function () {\n            _this.handleScroll(nb_page + 1);\n          });\n        });\n      }\n    }\n  },\n  watch: {\n    visible: function visible(v) {\n      console.log(\"\".concat(v, \" is visible.\"));\n    }\n  },\n  created: function created() {\n    var _this2 = this;\n\n    this.rpc(\"block\", \"read\", {\n      nb_block: this.nb_block,\n      nb_page: 0\n    }, true).then(function (r) {\n      _this2.img = r.img;\n      console.log(\"r\", r);\n      window.addEventListener('scroll', function () {\n        _this2.handleScroll(0);\n      });\n    }).finally(function (r) {\n      _this2.loaded = true;\n    });\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;AAIA,eAAA;AACA,EAAA,IADA,kBACA;AACA,WAAA;AACA,MAAA,MAAA,EAAA,KADA;AAEA,MAAA,GAAA,EAAA,IAFA;AAGA,MAAA,OAAA,EAAA,CAAA,IAAA,CAHA;AAIA,MAAA,QAAA,EAAA,KAAA,MAAA,CAAA,MAAA,CAAA;AAJA,KAAA;AAMA,GARA;AASA,EAAA,OAAA,EAAA;AACA,IAAA,YADA,wBACA,OADA,EACA;AAAA;;AACA,UAAA,IAAA,GAAA,KAAA,KAAA,gBAAA,OAAA,EAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,IAAA;;AACA,UAAA,CAAA,KAAA,OAAA,CAAA,OAAA,CAAA,EAAA;AACA,YAAA,GAAA,GAAA,IAAA,CAAA,qBAAA,GAAA,GAAA;AACA,aAAA,OAAA,CAAA,OAAA,IAAA,GAAA,GAAA,MAAA,CAAA,WAAA,GAAA,GAAA;AACA;;AACA,UAAA,KAAA,OAAA,CAAA,OAAA,CAAA,EAAA;AACA,QAAA,MAAA,CAAA,mBAAA,CAAA,QAAA,EAAA,KAAA,YAAA;AAEA,aAAA,GAAA,CAAA,OAAA,EAAA,MAAA,EAAA;AAAA,UAAA,QAAA,EAAA,KAAA,QAAA;AAAA,UAAA,OAAA,EAAA,OAAA,GAAA;AAAA,SAAA,EAAA,KAAA,EAAA,IAAA,CAAA,UAAA,CAAA,EAAA;AACA,cAAA,MAAA,GAAA,QAAA,CAAA,aAAA,CAAA,KAAA,CAAA;AACA,UAAA,MAAA,CAAA,GAAA,GAAA,CAAA,CAAA,GAAA;AACA,UAAA,MAAA,CAAA,GAAA,kBAAA,OAAA,GAAA,CAAA;;AACA,UAAA,KAAA,CAAA,KAAA,CAAA,UAAA,CAAA,WAAA,CAAA,MAAA;;AAEA,UAAA,MAAA,CAAA,gBAAA,CAAA,QAAA,EAAA,YAAA;AACA,YAAA,KAAA,CAAA,YAAA,CAAA,OAAA,GAAA,CAAA;AACA,WAFA;AAGA,SATA;AAUA;AACA;AAtBA,GATA;AAiCA,EAAA,KAAA,EAAA;AACA,IAAA,OADA,mBACA,CADA,EACA;AACA,MAAA,OAAA,CAAA,GAAA,WAAA,CAAA;AACA;AAHA,GAjCA;AAsCA,EAAA,OAtCA,qBAsCA;AAAA;;AACA,SAAA,GAAA,CAAA,OAAA,EAAA,MAAA,EAAA;AAAA,MAAA,QAAA,EAAA,KAAA,QAAA;AAAA,MAAA,OAAA,EAAA;AAAA,KAAA,EAAA,IAAA,EAAA,IAAA,CAAA,UAAA,CAAA,EAAA;AACA,MAAA,MAAA,CAAA,GAAA,GAAA,CAAA,CAAA,GAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,GAAA,EAAA,CAAA;AACA,MAAA,MAAA,CAAA,gBAAA,CAAA,QAAA,EAAA,YAAA;AACA,QAAA,MAAA,CAAA,YAAA,CAAA,CAAA;AACA,OAFA;AAGA,KANA,EAMA,OANA,CAMA,UAAA,CAAA,EAAA;AACA,MAAA,MAAA,CAAA,MAAA,GAAA,IAAA;AACA,KARA;AASA;AAhDA,CAAA","sourcesContent":["<template src=\"./template.html\"></template>\n<style src=\"./style.css\"></style>\n\n<script>\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tloaded: false,\n\t\t\timg: null,\n\t\t\tvisible: [true],\n\t\t\tnb_block: this.$route.params.id\n\t\t}\n\t},\n\tmethods: {\n\t\thandleScroll(nb_page) {\n\t\t\tlet elem = this.$refs[`page_${nb_page}`]\n\t\t\tconsole.log(elem)\n\t\t\tif(!this.visible[nb_page]) {\n\t\t\t\tlet top = elem.getBoundingClientRect().top\n\t\t\t\tthis.visible[nb_page] = top < window.innerHeight + 100\n\t\t\t}\n\t\t\tif(this.visible[nb_page]) {\n\t\t\t\twindow.removeEventListener('scroll', this.handleScroll)\n\n\t\t\t\tthis.rpc(\"block\", \"read\", { nb_block: this.nb_block, nb_page: nb_page+1 }, false).then(r => {\n\t\t\t\t\tlet newImg = document.createElement(\"img\")\n\t\t\t\t\tnewImg.src = r.img\n\t\t\t\t\tnewImg.ref = `page_${nb_page+1}`\n\t\t\t\t\tthis.$refs.read_manga.appendChild(newImg)\n\n\t\t\t\t\twindow.addEventListener('scroll', () => {\n\t\t\t\t\t\tthis.handleScroll(nb_page+1)\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t},\n\twatch: {\n\t\tvisible(v) {\n\t\t\tconsole.log(`${v} is visible.`)\n\t\t}\n\t},\n\tcreated() {\n\t\tthis.rpc(\"block\", \"read\", { nb_block: this.nb_block, nb_page: 0 }, true).then(r => {\n\t\t\tthis.img = r.img\n\t\t\tconsole.log(\"r\", r)\n\t\t\twindow.addEventListener('scroll', () => {\n\t\t\t\tthis.handleScroll(0)\n\t\t\t})\n\t\t}).finally(r => {\n\t\t\tthis.loaded = true\n\t\t})\n\t}\n}\n</script>\n"],"sourceRoot":"src/components/Block"}]}